{% extends 'base.html' %}
{% block content %}

<style>
.ingredient-form {
    border:1px solid black;
    margin:20px;
    padding:20px;
}
.hidden {
    display: none;
}
 </style>

 {% include 'recipes/partials/forms.html' %}
 
 {% for ingredient in object.get_ingredient_children  %}
    {% include 'recipes/partials/ingredient-inline.html' with object=ingredient %}
    
{% endfor %}
    
<script>
    document.addEventListener('click',(event)=>{
        if (event.target.id == "add-more"){
            add_new_form(event)
        }
    })
    const totalNewForms = document.getElementById("id_form-TOTAL_FORMS")
    function add_new_form(event){
        if (event) {
            event.preventDefault()

        }        
        const currentIngredientForms = document.getElementsByClassName("ingredient-form")
        const currentFormCount = currentIngredientForms.length + 1
        const formCopyTarget = document.getElementById("ingredient-form-list")
        const copyEmptyFormEl = document.getElementById("empty-form").cloneNode(true)
        copyEmptyFormEl.setAttribute("class","ingredient-form")
        copyEmptyFormEl.setAttribute("id",`form-${currentFormCount}`)
        const regex = new RegExp('__prefix__','g')
        copyEmptyFormEl.innerHTML = copyEmptyFormEl.innerHTML.replace(regex,currentFormCount) 
        totalNewForms.setAttribute("value",currentFormCount + 1)
        formCopyTarget.append(copyEmptyFormEl)
    }

</script>
{% endblock %}